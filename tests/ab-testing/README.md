# FormaOS A/B Testing Framework Documentation\n\nComprehensive A/B testing framework integrated with PostHog analytics for data-driven optimization.\n\n## üéØ Overview\n\nThe FormaOS A/B testing framework enables controlled experiments to optimize user experience, conversion rates, and feature adoption. Built with statistical rigor and seamless integration with our analytics pipeline.\n\n### Key Features\n- **PostHog Integration**: Seamless feature flag and analytics integration\n- **Statistical Rigor**: Proper significance testing and confidence intervals\n- **React Components**: Easy-to-use hooks and components for frontend integration\n- **CLI Management**: Command-line tools for test management and reporting\n- **Multiple Variants**: Support for multivariate testing beyond simple A/B\n- **Audience Targeting**: Segment-specific testing capabilities\n- **Automated Reporting**: Comprehensive test results and analysis\n\n## üìä Quick Start\n\n### 1. Install Dependencies\n`bash\nnpm install posthog-js\n`\n\n### 2. Set Up A/B Testing Provider\n`jsx\n// app/layout.tsx\nimport { ABTestProvider } from '../lib/monitoring/ab-testing';\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        <ABTestProvider>\n          {children}\n        </ABTestProvider>\n      </body>\n    </html>\n  );\n}\n`\n\n### 3. Use A/B Tests in Components\n`jsx\nimport { useABTestVariant, ABTestVariant } from '../lib/monitoring/ab-testing';\n\nfunction HomePage() {\n  const { variant, trackConversion } = useABTestVariant('homepage_hero_2026_q1');\n  \n  const handleSignupClick = () => {\n    // Track conversion when user signs up\n    trackConversion();\n    // ... signup logic\n  };\n  \n  return (\n    <div>\n      <ABTestVariant testId=\"homepage_hero_2026_q1\" variant=\"control\">\n        <HeroOriginal onSignup={handleSignupClick} />\n      </ABTestVariant>\n      \n      <ABTestVariant testId=\"homepage_hero_2026_q1\" variant=\"minimal_value_prop\">\n        <HeroMinimal onSignup={handleSignupClick} />\n      </ABTestVariant>\n    </div>\n  );\n}\n`\n\n### 4. Manage Tests via CLI\n`bash\n# List all tests\nnpm run ab-test:list\n\n# Show specific test details\nnpm run ab-test show homepage_hero_2026_q1\n\n# Validate test configurations\nnpm run ab-test:validate\n\n# Generate test report\nnpm run ab-test report homepage_hero_2026_q1 html\n`\n\n## üß™ Test Configuration\n\n### Test Definition Structure\n`typescript\ninterface ABTestDefinition {\n  testId: string;              // Unique test identifier\n  name: string;                // Human-readable test name\n  description: string;         // Test description\n  status: 'draft' | 'active' | 'paused' | 'completed';\n  startDate: string;           // ISO date string\n  endDate?: string;            // Optional end date\n  trafficAllocation: number;   // Percentage of users (1-100)\n  targetAudience?: string[];   // User segments to include\n  variants: ABTestVariantDefinition[];\n  successMetrics: ABTestMetric[];\n  hypothesis: string;          // Expected outcome\n  minSampleSize: number;       // Minimum participants needed\n  maxDuration: number;         // Maximum test duration (days)\n}\n`\n\n### Example Test Configuration\n`typescript\n{\n  testId: 'homepage_hero_2026_q1',\n  name: 'Homepage Hero Optimization Q1 2026',\n  description: 'Test different hero section designs to improve signup conversion',\n  status: 'active',\n  startDate: '2026-01-15T00:00:00Z',\n  endDate: '2026-03-15T23:59:59Z',\n  trafficAllocation: 50, // 50% of users\n  targetAudience: ['new_visitors', 'organic_traffic'],\n  hypothesis: 'A cleaner hero design with stronger value proposition will increase signup rate by 15%',\n  minSampleSize: 1000,\n  maxDuration: 60,\n  variants: [\n    {\n      id: 'control',\n      name: 'Original Hero Design',\n      weight: 50,\n      config: {\n        design: 'gradient_hero',\n        headline: 'Transform Your Business Operations',\n        ctaText: 'Start Free Trial'\n      }\n    },\n    {\n      id: 'minimal_value_prop',\n      name: 'Minimal Value Proposition',\n      weight: 50,\n      config: {\n        design: 'minimal_hero',\n        headline: 'Operations Made Simple',\n        ctaText: 'Get Started Free'\n      }\n    }\n  ],\n  successMetrics: [\n    {\n      name: 'signup_conversion',\n      type: 'primary',\n      description: 'Percentage of visitors who complete signup',\n      successCriteria: {\n        direction: 'increase',\n        threshold: 15, // 15% improvement\n        confidenceLevel: 0.95 // 95% confidence\n      }\n    }\n  ]\n}\n`\n\n## üéõÔ∏è React Hooks & Components\n\n### useABTestVariant Hook\nGet variant assignment and track conversions for a specific test:\n\n`tsx\nconst { variant, inExperiment, isControl, trackConversion } = useABTestVariant('test_id');\n\n// variant: string | null - assigned variant ID\n// inExperiment: boolean - whether user is in the test\n// isControl: boolean - whether user got the control variant\n// trackConversion: (value?: number) => void - track conversion event\n`\n\n### ABTestVariant Component\nConditionally render content based on variant:\n\n`tsx\n<ABTestVariant testId=\"pricing_test\" variant=\"two_tier\">\n  <TwoTierPricing />\n</ABTestVariant>\n\n<ABTestVariant testId=\"pricing_test\" variant=\"three_tier\">\n  <ThreeTierPricing />\n</ABTestVariant>\n`\n\n### withABTest HOC\nCreate variant-specific component versions:\n\n`tsx\nconst MyComponentWithTest = withABTest('my_test', {\n  control: MyComponentOriginal,\n  variant_a: MyComponentVariantA,\n  variant_b: MyComponentVariantB\n});\n\n// Usage\n<MyComponentWithTest {...props} />\n`\n\n### useABTest Hook\nAccess the full A/B testing context:\n\n`tsx\nconst {\n  getVariant,\n  isInExperiment,\n  trackConversion,\n  getExperimentMetrics,\n  getAllActiveTests\n} = useABTest();\n`\n\n## üìà Analytics Integration\n\n### PostHog Setup\nThe framework integrates with PostHog for feature flags and event tracking:\n\n`javascript\n// Feature flag configuration in PostHog\n{\n  \"ab_test_homepage_hero\": {\n    \"config\": {\n      \"name\": \"Homepage Hero Test\",\n      \"variants\": [\n        { \"id\": \"control\", \"weight\": 50 },\n        { \"id\": \"variant_a\", \"weight\": 50 }\n      ],\n      \"trafficAllocation\": 50\n    }\n  }\n}\n`\n\n### Event Tracking\nAutomatic tracking of key events:\n- `ab_test_assignment`: User assigned to variant\n- `ab_test_conversion`: Conversion event tracked\n- Custom events with test context\n\n## üìä Statistical Analysis\n\n### Sample Size Calculation\nBefore starting a test, calculate required sample size:\n\n`typescript\n// Minimum detectable effect: 15%\n// Base conversion rate: 10%\n// Power: 80%\n// Significance level: 5%\n// Required sample size per variant: ~1,100 users\n`\n\n### Statistical Significance\nTests automatically calculate:\n- **Confidence Level**: 95% default\n- **P-value**: Statistical significance\n- **Confidence Intervals**: Range of expected values\n- **Statistical Power**: Ability to detect true effects\n\n### Early Stopping\nAvoid peeking bias with proper early stopping rules:\n- Minimum runtime: 1 week\n- Minimum sample size: Met before stopping\n- Sequential testing: Bonferroni correction applied\n\n## üéØ Test Examples\n\n### 1. Homepage Hero Test\n**Hypothesis**: Simplified hero design increases signup conversion by 15%\n\n`tsx\nfunction HomePage() {\n  const { variant, trackConversion } = useABTestVariant('homepage_hero_2026_q1');\n  \n  return (\n    <>\n      <ABTestVariant testId=\"homepage_hero_2026_q1\" variant=\"control\">\n        <HeroOriginal \n          onSignup={() => trackConversion()}\n        />\n      </ABTestVariant>\n      \n      <ABTestVariant testId=\"homepage_hero_2026_q1\" variant=\"minimal_value_prop\">\n        <HeroSimplified \n          onSignup={() => trackConversion()}\n        />\n      </ABTestVariant>\n    </>\n  );\n}\n`\n\n### 2. Pricing Page Layout\n**Hypothesis**: Two-tier pricing increases plan selection by 20%\n\n`tsx\nfunction PricingPage() {\n  const { trackConversion } = useABTestVariant('pricing_display_2026_q1');\n  \n  const handlePlanSelect = (planId: string) => {\n    trackConversion();\n    // Handle plan selection\n  };\n  \n  return (\n    <>\n      <ABTestVariant testId=\"pricing_display_2026_q1\" variant=\"control\">\n        <ThreeTierPricing onSelectPlan={handlePlanSelect} />\n      </ABTestVariant>\n      \n      <ABTestVariant testId=\"pricing_display_2026_q1\" variant=\"simplified_two_tier\">\n        <TwoTierPricing onSelectPlan={handlePlanSelect} />\n      </ABTestVariant>\n    </>\n  );\n}\n`\n\n### 3. Onboarding Flow\n**Hypothesis**: Streamlined 3-step onboarding increases completion by 25%\n\n`tsx\nfunction OnboardingFlow() {\n  const { variant, trackConversion } = useABTestVariant('onboarding_flow_2026_q1');\n  \n  const handleComplete = () => {\n    trackConversion();\n    router.push('/dashboard');\n  };\n  \n  if (variant === 'streamlined_quick_start') {\n    return <QuickStartFlow onComplete={handleComplete} />;\n  }\n  \n  return <ComprehensiveFlow onComplete={handleComplete} />;\n}\n`\n\n## üõ†Ô∏è CLI Commands\n\n### List Tests\n`bash\nnpm run ab-test:list\n# Output: All tests with status, traffic allocation, and variants\n`\n\n### Show Test Details\n`bash\nnpm run ab-test show homepage_hero_2026_q1\n# Output: Complete test configuration, variants, metrics, and current results\n`\n\n### Validate Configuration\n`bash\nnpm run ab-test:validate\n# Output: Validation results for all test configurations\n`\n\n### Generate Reports\n`bash\n# JSON report\nnpm run ab-test report homepage_hero_2026_q1 json\n\n# HTML report\nnpm run ab-test report homepage_hero_2026_q1 html\n\n# CSV export\nnpm run ab-test report homepage_hero_2026_q1 csv\n`\n\n### View Current Results\n`bash\nnpm run ab-test results homepage_hero_2026_q1\n# Output: Live results with participants, conversions, and significance\n`\n\n## üìã Best Practices\n\n### Test Design\n1. **Single Variable**: Test one change at a time\n2. **Clear Hypothesis**: Define expected outcome and magnitude\n3. **Sufficient Sample Size**: Calculate before starting\n4. **Proper Duration**: Run for full business cycles\n5. **Control Quality**: Ensure fair comparison\n\n### Statistical Rigor\n1. **Pre-define Success Metrics**: Before starting the test\n2. **Set Significance Level**: Typically 95% confidence\n3. **Avoid Peeking**: Don't stop early without proper analysis\n4. **Document Everything**: Test rationale and methodology\n5. **Learn from All Tests**: Document insights from failed tests\n\n### Technical Implementation\n1. **Consistent Assignment**: Users get same variant across sessions\n2. **Performance Impact**: Minimize impact on page load\n3. **Fallback Handling**: Graceful degradation if test fails\n4. **Clean Implementation**: Remove test code after completion\n5. **Monitoring**: Track test performance and errors\n\n### Audience Segmentation\n1. **New vs Returning**: Different behaviors\n2. **Traffic Source**: Organic vs paid traffic\n3. **Device Type**: Mobile vs desktop\n4. **Geographic**: Regional differences\n5. **User Type**: Free vs paid users\n\n## üîß Configuration Files\n\n### Test Definitions\n- `tests/ab-testing/test-config.ts`: All test configurations\n- `lib/monitoring/ab-testing.tsx`: React framework implementation\n- `tests/ab-testing/ab-test-cli.ts`: CLI management tools\n\n### Integration Points\n- PostHog feature flags\n- Analytics event tracking\n- User session management\n- Results storage and reporting\n\n## üìä Predefined Tests\n\nThe framework includes several predefined tests ready for activation:\n\n1. **Homepage Hero Optimization** - Test design variants for conversion\n2. **Pricing Page Display** - Compare layout effectiveness\n3. **Onboarding Flow** - Optimize user completion rates\n4. **Dashboard Layout** - Test customization vs fixed layout\n5. **Mobile App CTA** - Optimize mobile app download prompts\n\nEach test includes:\n- Detailed configuration\n- Success metrics definition\n- Statistical requirements\n- Implementation examples\n\n## üöÄ Getting Started\n\n1. **Review Test Definitions**: Check `tests/ab-testing/test-config.ts`\n2. **Validate Configurations**: Run `npm run ab-test:validate`\n3. **Set Up Analytics**: Configure PostHog integration\n4. **Implement Tests**: Add components with A/B testing hooks\n5. **Monitor Results**: Use CLI tools for ongoing analysis\n6. **Document Learnings**: Record insights and iterate\n\nThe A/B testing framework provides a robust foundation for data-driven optimization across the FormaOS platform. Use it to validate hypotheses, improve user experience, and drive business metrics through controlled experimentation.
